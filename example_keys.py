from collections import namedtuple

BaseKey = namedtuple('Key', ('n', 'e', 'd', 'p', 'q'))

class Key(BaseKey):

    def __new__(cls, n, e, d=None, p=None, q=None):
        if None not in (p, q):
            if n != p * q:
                raise ValueError('n != p * q')
        elif p is not None:
            q, remainder = divmod(n, p)
            if remainder:
                raise ValueError('n is indivisible by p')
            q, p = sorted((p, q))

        return super(Key, cls).__new__(cls, n, e, d, p, q)

    def encrypt(self, msg):
        return pow(msg, self.e, self.n)

    def decrypt(self, ciph):
        return pow(ciph, self.d, self.n)

    @property
    def public(self):
        return type(self)(self.n, self.e)


wikipedia = Key(n=61*53, e=17, d=413)

small_256b = Key(0xbf12d8819d36e5a6a1964a9dff3ace76eee4fb07558452f9ea6d7197eee9586f,
               65537,
               0x692a4f3defb0f26f674a9821240452f4118ccd95e488cbebc4ada40a088ec5f1)

huge_16384b = Key(
    0xb7e7d71bca1eae3959526666f6f7620ba41952532f11a52eaebb5abe42ba92fa01169a46018510f97ed3aefb4834d272053d8c508181d23024a2b4acb366541a98bf3a077442a05118e0a8b5b35d8c7548fded24fb592b73f25211438fcefa852586ac703fa09188d266376098b10e3645d0e55921d67164c4ce28ba097826ad6e78fe3e0638dd69771ff4b30539fdcbef66768ed8f343a9ab1b1e4c9b2d1d61a1a28651e854bba879a9348e27fc87bf27faaa6f7a6e35292d0d4b9b0b2a4d02fa74248289743b1c9c66cd649bdb8f86ac568075e2328e7c5ee4f558e8ec7b227f711413fe8f5007ca808ff2aedf189a89f2a97b0f47b7f09c02fa786530612337d5a7232003aee6323a2507e30cab470bd9d3fb141b0283c969647b41ae7aafe868faca8d753af6fa87a554baef23cbd7305375f8d3a9c11b15154a9494e4badb850e5ebc7f8628a895ceecf471cd083c666cd9540f686ef9bccef66d3b7e14fe93b82b92e14de8846048b3c145d85a79ef56ea3efd0bf294fb854a4e3b28794b8853eab86db19c228b2784c1cde9a7be7519bdb6014f13b345833325de95cf8db744ba9d90910fa60d06ff4cb1ba0923011527b904c2abe61af031b617ddb08013306f74f9bcd1caa84953f14511888c8e282266a1815700d2589a30d2b71ff010c7a87a301c8a7a82c6cdf115e56a802eb06234b951248e91b79806538ed0fb788429bf36af832ac9fc22616af5163dde0caf3481b4bfd5ea4342df58b544c1f99133ba8def001dffca4c13e5c0aa97ea5fe14a9726fc269ebc1931399f57d7a69b5337a6cc351d1677e2c7ff95f239cdc7e675e2880dc814c76efe568e7d853370bff7ff846b7bed9b4fa881a3d6263360a42eeea253e0c6205a0c2b1a9a9763d5757a4a3e58025e92ca099d301edf66c67c8fa906064ebc6abc04f646d7d42b39d05a20ac5b9cf93738a18c89076e5c44a8ed73060a68fe65c37596bfae3cbb7d4c828c6192ef722a7c8350ee3488f9af821663160f9f54d9214af6c59b4af2335245e706adfc3e53880089e4f0440135a6d96f1c2f2c22fdfcd311a576582164ba1291c83de1c2fc4118b593e32f126a62878197d787cb4b7a1b554c1322df5a573b4dcd47b6c722efa383ec9169e64e8348481383877d51d103ff233ebf2d4d283f5386a625fe36993f03ca0a4a6e3543feb870b11c1f9384a891e64183de4ebac1ad99fc13a490fd899f90c43815281c0699e27b19be3206c905b76a8630ec9f8f083da613bfc172f2cde8210792bb165afa5c7b95d27d5737c56eb549b7eefc07b65d847ecbaf99ad182c75e9b33e28f485530a8579a449a61e6b98fd0b158b1fb1bb5f7bacf4906424f71583e7d57761c381d5e4f1bb4e8a4c5361ea94e35225bfd6853898714bd88de84e5352205a8103a6206f6a931545e4dab41c65b2095359c374d1a027756eb9dae79340cd1d8e723875c30709d9d85b9f29a8af5468594adb240de6f91ab9eea3eb1c5262fc13cc6e92139696473061cd43f610005a9569988d06885373dec333ec126a2e7958dfa50e7dfe24c252e6d5e1106c7698835d0718c794cf42f422c4e4d7c22649a67d7d1a94ce91dbf7067d1f989d54c949c1651e2df4558962ad044dd78058e1b11edf99c0581e17ea124fc129585c3cb38432e571e93ae1cc6ff35cf73b1ddf9446ddcc6196b51d53be34e7151de8fc6e4d16055087e8a67977b052b446e8aafb2ff688d556297fc30aa8e933cbe8636b21d4c90076105136d551c88011bb04d0c3ddea6cf132738178b8637aeef3ba50246c27f6b5b6ed66b862108d741c18791816245d91d226825d802147a6cf64afdb52d67f228cf4586850b894924cfb660624e5830762eda38b6f552159d3a170f15db9f9ae477c9b62ff123a307d441f7edfc0a3ea4b5f12d4221efed3927a02bb4352a0568970c10aba4c19e20bb9d69264b6be6b9533f777458eb84e6c92c0965aaf4874bd6df29e9d911b52a6408b4c0cab60ce3b2ad0f49cd533651b8f0dd27b0c079b55be0cb9dd6f7650c2da025d4b06269cb3da789de250d9865cb0c3b9dd3c3940d79e3ee4db86060f3b20f1200f6234e3e898dda37a2bb2179a5741ada337b20123f89181a91a3c43c9e1b1898feaafa60dd6119a86813ac64bccc0abd3d9a4b5660a9fecd13c00551a3775f6c500a34ca74ebe3155fb699a9a53d2d034e3994538afb79019b6e938663cef75eba9c2b622e4ca1b5981540b2bb70ae6501ca0d0a92a69349672ead894de81c1ea5652488172ec55d52ea026c1cb692cc326c377fbb4ad89d90291323b856e65ac51328a814321911653c56dd41aa1af40eefa2c865824bc6a17be97c7ed49bcaaca3b8b19a8617c79a373f6285134dce17dde0f39f18f9061a36a7ab29fe622aa842fced4cb620887177b5618dc397bc91ba04e71474fef7c4b05d10a169fefa4a93476f5fa0c3003b6afd1a81b59b08e9a7e40c89f83fd2ffa52e4aa1ff2a5ac0ef31e53b96680dfa9aec4c5c7211deb3417ab20f33a597715f9b60d3f3838f070f753a8b9854f6e85419194e138c2a53888f8b86a202864d62faff24354ac3a6f283702e9f2ccc3452c7956c408a7e036821b211db3afdc894a87d3719f536eff0b1c9f93f99f679724f59a2917486b80dadb41c25ae076232bb03ad67656d68e70e5e41183776e448d882611c1a67813ed2bcd640e9dd087a93ceeaaac55c73e03dedf99bdd9945b25043d775ded1d31e0fdfbfa93ed33cbf2dd1bf48d334b86525f0eb481e9398339a1f5cc2f7548bfe2ca36c4733074baffcffa55f21afa465591eb84c6cb78898c6068a74d4e9937ab980981b9495133a3bcdd364872133c36768902d1bc24c1
    ,
    65537,
    0x41ad7580022df4d09c5ab6217d7f99af489a967108b54785a577598feb2ad084a250dd25b5333d7dacd2928241264425de433dd21e7e2b7f7005ff7a51d370a3d2fb30112b6f03ec1273612d0af294cfea126d57b0c006a9b0d7a83cb5a61887e67ff3235f45cbd3ce381cfccd6b260531e7c9908c6a163303aa109767fc55ebc83143b308ebd3feef412555adbf292964c4f6004bf08cb0925febf135d5e5d1513546bd07b9030fc6eb2bcebcef0dd7b1c26e8dc36e8a63bb282d61209aa9c82f83bcea3586a1f9b4cd6dfac9429f3e5c5bc422d57672b66df95cb9b4ed878829754bd35c2cf84ae0020be68297402528b0d5e011f3edf7eaef915ddfdd684378943fcd66888a34c1a94c4245cee77846fe331b4ef1da7310422855707e8c68381b0dbdbac92c16ba2029665a203f6b73dd59611f4d1029dbaf2adc68b5c7fe0799bc290f2e87ce0b6efce858e02f760a8415c983a0c10e28f849fd6dc33a62eb0bfc50eb72b52d1de178f56147bd5d8a80744cd1d3f3295e157963b10ea584b3f9eae63f99453dda8451c7b2a3041819079efac67e2f2c7cf08d4b7df1c114cfaaaccbecab8d72c63d8ecb2c2ba8a1ccb37d47a366d4d3292963b08d3476c2aaeaaf788e9105e2f27a293de64361609fb9c111900f8bae73a7ab66dd9ad3357fb9ae6437c6e8da77a82eb1abb0c32ec6ba65d99cb4b60ad533ab1a8adfda783de6ab64715a6951f1bd12e38060ff48432e02dfab63cb165ba1ff0569d8375c67dde6025054920f3ba7772ab64c6e033e9fc04028305506e60ff86312d65e56b3b8576e5fc89cd33721280d8099818671285184b783004dd3afc00d9e9d70e3d8e7271417d0540d42c3f79c7a345a3b8786ffb382e34c6ba2317faa490037cf0fd3e28ec2eeb2d721797ef8d278259050fe565273c7cc5402587dd1c9ffde0b0445afaefe10ff1cf4b1780c2c7d910e6b565e5ae9fa1325329befe1df23c82ec497bcc6cf34ad40196d6f48ea68c3b95555be5d39fb870c6b3d9511b3c0ef8f67339a2a7eb664074cb74183a79597824af7179f0fb6039dc1287a0689a69aadea097afc8cd72d6914305b802fffe0e1d894be13940b2f1c14ee00758a3f6b1cc66e77c80170e6a7fed99d5b71cd127658189cdf7bb7e9e82642162f0c3b58edf6be89f89ead08c05b7f2f26897fa3ef0ae7d2f4068afe0bf25c4085b6e1ec1667aec3f52468083f2310b98b22542f12346931dad86caa9a85f60bcdaa8af51700f785f9f1cde29e661d2c4c0df4853b0e86537447677411dacec25e9c9750d3439181b2d65a4589a4f2bf32a5c3a55532f2057800e38065988779a9a7bee3744ea25fbe40c26b854d18d67a9e9928f8b113e1837211ad53a320c560e6391dea31299d09605be393ce437aeab85aeda4d352d8251a40205b230f2f9a004d1be16d5bbc5eac81c6d0917350750e46148d2c8e87a7e66a7497c550e06cc19716f969fca3691a77b514bc25da3c418c0d9bfca5ccffab254fae2cb3ff7ff6765606391c7e5a73de512d395db952643ab9b2d4b4deb77d679d734e8da15abb9e72de99a569dc4b76655515d796a60dcf2b83844531bbd02f5c422ce11783309355bc516e23526f09899b7c664b20c37a776524676082cda5428950d2a7500eca3a9f790558e51fee631964484710fc08519a6fe8683a41f5f592e66c30828b65b8298d7be093631bbb259e6b8387ad7b33e6be65a40ae67ad9ddb5b6ab1577297fb0a81e1952c1135594cd53d32a17aaa2ba75e7ef7c789ee1724a25a4eb453b67b09975d806854a25a21268eb1b50593a44066ffd92d7f3f2f4b89e917a82a86e4e0038485b8aabdec73b396a678a0c8c1997505aeec7ac16a9150c2c92d895ad247445b593e33f2493fa4804a7a70ae0b01268b1153bdbbed6b469396e83ad758153193500dadceec721902137eb7018df24012e56cc4f92fe765292907ffba209ce22cb9de2d11304245556ca227d695032e86cf0123de6eec81c846e354ca93bbf01ed552a442f3fe45c7ff318064443958f060838eefb287565703d8a4be3f737e28136527a2076db11fff94852b3a616d979c65f23517641b57a4a7760ccc79ebc9e165f85c5ebafe595a891044c7db81ff6d1da6f1fd22288bdb21a8b4cc2ddf4cac4d200665faa19b9413da219c125c4f770eb23362233515813494cd321445c7fbd0d5ef2390b409030ded8b557be545dc5ad350aeae8e0abb2d52e26333b1d84373f2a9eaf9d7c7265051f0eeab0c71fe3bc36013e7ab0bcc3db3f5533491c1041a7b3f95ad2a08f52d1d1327a6587335e26f964af9d589d809492b0e2e5341e25119bda7ca9021974287a6c78ad93b07c5978e3baaaa6dce7a549e33eedb362dbc8b9fa554b821db830dc0e3e77b93cfc5f438899164bc93703bff1467d05602355237e74b6cb96c93b6b9420deb765f3049d15d6b9ebd97bd8ed4e75cb167eacd9e6f8ad492a1cafe60aa8dd8810407747445326bf93a4ae07f032ae5a725c11d3cd667a383081978019a1ddc8c7ee4ba567ac3b191adc58883f96c481664e6f4e811c7f277a1cde3a16795ed390fe4ec8343e05b3510578e842c26ec1de28f32cb0d8571cf4fee023a3bc91ec898d62846cdd1fc9e114d19748ea569d9a4a3f84fd30046c8ba31afa4b28682b60ed2183ada848d684dc1b0989771ff56564fc80a1d38e49aabf4a06c5740d290556ce92ed86383328e45206a0b5b20314958a99674cc58f1c7b9b0bd6528a707a7aa20107eece869677915265c1c1cfcdf9ebfb80deda6528d9ede0e95e9cc104e62a770f1e181c591483c9a5b949e65acb38f44e2de03f2bb51767d9bfded311cc3706e1a0bd4a3937ddbd76f475
    ,
    p=0xec47b12a7ce64d4c3775f17afde37711e3b5b1834f40026c8b745e5e9e7d46e21bf2ffe52384f3a6489bdc1ba525f6239d5e465377f169da365bd627c4007052a5cda8a23c028f938a74b1eca30bc778d948dea0133afc324e0172e461b00274a68da180e209609077e00d443ac0474585ed6ed87032cc61d6033ddf352a3dddb96d7e49a7a7d41a15137d642a29aa7f13e680ecfdba82bf8cedc3cbc2ce97dabdabbd7011135d3ff05f998be4bbe72f07427b530e22659b1bccb09be0e852808c651eca93e6f5fa28b2c7069150145f81f3d16437640869708d0922b6cab29746e1d21d15508fa2a7c07e39f3cd76193e403bb9707c42dcda37dae9f04e2c5dcf088841fe621b9ee96e7153018fd293d6c24129b20c5ab8365036313d579e2dec0e7abb1d9a5410da8abb7d754a2244158dbb8445a733be221af522d5785671135e0c02d1cff6208d4bf5a10545bd951ba1d6cb31641184ce9579d48a306e0d681ec184f415c7c3b75df2f62442eb87932c8ddf460ca9c28888537e83a5a9c88e1eab1effc70c4d2b305e230dc60b372250c954df816eb9cc7042ad9b2316724dfe74ddb892ed8192a96528622e6e51b0249096050f1b2fbe08baa9f029b1f5443f754b09795a7af4e23c2a1215d0f4658c327548404f44189b5b42314d868e40218663dc8264240fb9cc721c64fd2185935a59013fcd6303b416f5c5e770a79184eb4c1bc8d2ffdccdf1f3c0408715acce4eca2fbc8f1a8f997ce46912c63b82b10db58edcbd9d91cec53e683ae76878b82774a91f0579acd4aeb0e118d16b2ddeb9327e6ed60898965f2cd975f704e36c14af6fcdef03358cb9fb96d1316b621f1e07fab92d140e6e7d45ff21ba30dbd7a81560dd255e04913270d328b324bb164d0fbc7d6a835285ff38d5a43d938acedf2ee7f36c33304957e460950dbf49dd0d525bd9336fc3e7aa31905b32d3f7e5f29959f114372617d10688e8edd215f4ef219fc1df7f3b592d9950abf4d57846f5cdfe805e759c24606fb1b84d8ffb7fbf85c64660e29e8b9249e01240469bdbb16e794a1d4066f8881e53720c0f8fac0acdc9915b847e63be082bf63bbd23468b20fbe9d54732c71ec81995039d76f9bcb80604cc27fb95a0d895c0867549ec7f679cf3d818c94c0dd7b97261b81ba82c79e2a35e78b5d4a90e5f6cc6f68ec9a8d5889b324e0df1d123091fb222973b141e2c539ae44b1224a305f029a4c91c4d36a49c8403d68be75839bfe3c6fb95bf45c92b030ef44ecd765bf7b706a774174fe389f6d9a8791e9ddf4f704c73d4a264762b7cf8e2a5662d8507dbca9ebd2f126ac9548955d02a8cff806ea1400511e38a97e966d85f9853e5e746f9ffe4573d6d3a631e6a01f8e8b07c141ee3075a06283b377032036309a2e7a9d356547f5627cc8df3317ef770ca1e2377,
)

# vim: nowrap :
